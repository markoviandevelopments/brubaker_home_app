name: Build iOS

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: macos-latest

    env:
      KEYCHAIN_PATH: build.keychain-db
      KEYCHAIN_PASSWORD: Pre$ton01
      P12_PASSWORD: Not$erp01

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Flutter
        uses: subosito/flutter-action@v2
        with:
          channel: 'stable'

      - name: Install dependencies
        run: flutter pub get

      - name: Analyze Dart code
        run: flutter analyze

      - name: Set up keychain
        run: |
          security create-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH
          security set-keychain-settings -lut 21600 $KEYCHAIN_PATH
          security default-keychain -s $KEYCHAIN_PATH
          security unlock-keychain -p "$KEYCHAIN_PASSWORD" $KEYCHAIN_PATH
          security list-keychains -d user -s $KEYCHAIN_PATH

      - name: Download certificate
        run: echo "TUlJTWp3SUJBekNDREVVR0NTcUdTSWIzRFFFSEFhQ0NERFlFZ2d3eU1JSU1MakNDQnFJR0NTcUdTSWIzRFFFSEJxQ0NCcE13Z2dhUEFnRUFNSUlHaUFZSktvWklodmNOQVFjQk1GY0dDU3FHU0liM0RRRUZEVEJLTUNrR0NTcUdTSWIzRFFFRkREQWNCQWppSU5Sc2huamw3UUlDQ0FBd0RBWUlLb1pJaHZjTkFna0ZBREFkQmdsZ2hrZ0JaUU1FQVNvRUVOZjFoaWJMVHo2bEtpN1lqVDA0bFZDQWdnWWdSQmJuRm5IYWk4ZzBMTjlKRkNXMElNa1dwZWptZTIvcGZTS001QTladDI1R3RFQTJXM0x3bFBKUzJPeXFvY1ZjdkhIejJhTThydHp0QzhIZHUxbGpmcXhqR0hiTlN2M1BadHVYMkloRHJTRFpBSE9UaEZIM2tueUFQcENyUnRPOHFzMnBSQkY2K2RjRis4OEx0OHlqN1piaUZRUCt1ZkY2ZGlCV1B1ZDBBL1ExMTBTQUdSODRlK1F1b2tqRkFyS3JHWjFhQVVqNG1vMmZabXRVTElGdG5vb0dFQmNGOU5XWnNrd25kalEyekJGZWhBNmFWVDRHZ1VaMkJVb25IL2hQUlR1eW9HSjlreVQ5K1VOM0RqSFNiUFNsYVBmWm9XQkxkZE9UejlaaDE0bnc2RWRqUXZFQ1BuRjJJQ0V1U0ZTdVkxS3BLMm1JVWZHanpGRVZJbDY1SmE2ZzhmRWVieTdxNTcwcWI5VXhkQkhWQzRTMHA4cDVZL01SM1NXSmFoa1BJQXdYc0lhcm4vbzFjMStZaGZKaTNteDhRRGw3ZzNPNnpCT0cvK0xieFcyOGpJNmNkRjlzRzY5eE1NQlZwTFB2WmhzalNnNjJ6NzI2RTdzZXBnYnR2alJqRjJhK2NmOFh1a3BHRHZ0RGE1bDNFSXZpUU1rZ3diYkVyVE5nVGVEQ2E1RU5Sc1EwWkFFWTRDbHFLYWNEM0dsUVJXRmNQd2NqYkM4K3gyRXJjNW9SK29NSUVDYjBaTUhtSFRrSzl0QlNrdkpiQWFvb1owMnZxOFg4RDBXbGRvVytNSmtQYlFMVWZJbHJFdzh6UHBLam9rV1RKYWVHWmcxN3dKU3diUThTRzVtVThteWY3NTEwcnJwdXU5NFJPTEIxQXN0ZnZ2azZUZTBDcVpyQ2dBTjFSVmY1aU9DclA2bkRLRi9PSEpCdHgrOVRPdmIwUlQ5OTVLZWlPSDYzV0dZKzk0QktjbllBdmRqN2Erd0cvcjN2b04ySVZlSjg5WlVIWE1JTSt0b1lnWkV3bnFEQ3FNeHh6ZEhuakFMV0pJaXNzZE9QTGdtZDIyVm96aUFMUFg5RXFkb3ZrT2hoOE1XV1pNVEREV01Qc2E4WWs4ZzlQWVZDMmVpencvVmZwa0ZlNFF5dEZ1Qk5TaWV4ZStvYkJsNnQ1YlJ2c1NJWVIxNHh6L29Ed2xRaUh1UWVjSkhGZVpNRlQ3SmFES3FsbTFWVGtjb05BaDZ5MzhTYVhkQ1VCZlpxOTQwVi9WVVpDWG1BUU0vOVlHUHhHSDV5YnJQNzY0QXJiQUJGUTBoZ2VSaDhjRVJ1K1VCc2tNSlVkeVRwbjdTWkhBM3dyMnVENCtTZE9mcW50VU5iMDB4bVdsNU9Eb0xBaDh4K2IyQXRxNFJNWXJaeEYxUUMwMHQvQU9RTzQ4WmFGei9OQzRzUkIzV2w0eXhodEdEQVcyaWN4NDZxcWpJZEJ6bmV4MGNrNUUvUmVXZk5BRXVjcDRiR3BGa2wybG93NkZ6TCtPZlFuYisyeTRTczBhM2x6VE5yM29pdXJmN1VBOXVBRVRwd3NiaEdwR3NvWlNLdkdyUzlqLzg0QThSNFdKcjU4WStoM2lIN05vZUt1VUpMRGpLQVlMbjM2SmhJTVhlRGhBTEQzMDMyVk9nSHgxSVlmSjd2VHlDQ1ozc0ZnSWtIVXhnaGo3T0RaRy93WlJlMDdzVUxOWTNWclYybG50Q3Q3SzZJaWhZYjlKeUIzRTRRMGcyUVA2WGlheDl1OUFPUVYrVThua3F3TjEwWDJobWpGcGRya0VhK21GVk5Vc2wvaDAxdm9WOW5ldFhucFBnQVRTUGtBdzlqOXhuTFN5bks3VG0vWnM4MmE1d2tQS3JGUUc3ZTRrbWVOSDVDcFJuNWRBaElFZEFKY1d2bCs1TERiN2Z1cWI0QWIxaGhVN2RVeGVqWjJQT0JpOG5IQ1pjdlVHcVovdlcvc25QdGo0ZUZRcVM0ZVR3Mi9zakFXKzZMZ3RWMU40eHlRdFAxbEUvMURYTDk1OExHMXIzbS9QaTVNNk40MDVKYmIzOVVNcnBJalU0SUpUREFhdGcva21JaEkzOW1pclhDSHZDZTVxajhTbjhMK25RcnZNNStQcGoya2dNTENaVXRud0VIYmFEbnlDQTl6MHNZTGsyZUM1WjBBdUZDTzFBSjdEUlhoZmtRWHZCdTBQWjN0QmNMVkI4Q0loQTJLOXMzWGVtUmh6RmFLSDkxbjdpRWttaU42MzhZODRHNzhDZlpnNmFNTzFJQVFwR3FHOXVybWt3YVVrTlE1dndvYlZ6NTFtb3VuSkR1N2lLczBRVWcxblFFVHl0dHpJK1M2MHMvYUdQNHpjb3RFSFo1em9zR293Tm5aQ0p6NjBueVNucnFBanVvcHJWdUVlNnp2YjQzTFlieEdVb3Q0elpGL0RPQldYZzRLT2d6cHFWSEErV0lMbDVQRGZhTXQ3QzZkbi9kVktiSldkWVJLUUFRV1BpY05CbUE1Tlpyc0ZlbzdDVkliWU1hRi9XN21qQ090ZGhDdFBVU0dDMEUreGlEellBWi9IRmlHdW8yYVM2NlpsTHMybUFkS2cxbjN5em8xcGhMRFpPQXpGT3R0N3RBMGExekRXcVVjQm50ZjlxSEtiMVJaaWswVHRNcXlHNVhkNkdaUXI5T3Exb3lxSkU0ZDY1c21VcjlzeGJqNzJBd1hJWlhoTTRtLzNZelFpOUNUbWJuaGNXemJIblJJcVZDOFgweGdsQnFiaWo1Qk9uSzJMT1orbk13Z2dXRUJna3Foa2lHOXcwQkJ3R2dnZ1YxQklJRmNUQ0NCVzB3Z2dWcEJnc3Foa2lHOXcwQkRBb0JBcUNDQlRFd2dnVXRNRmNHQ1NxR1NJYjNEUUVGRFRCS01Da0dDU3FHU0liM0RRRUZEREFjQkFndzhOdWpDZzNKQlFJQ0NBQXdEQVlJS29aSWh2Y05BZ2tGQURBZEJnbGdoa2dCWlFNRUFTb0VFQW5VSm0wM3hrME5CTTYraFN6TU11b0VnZ1RRY3A2NjM3QzZyaVF6ZUVQaGdyc3U3VStZTWxYQTJFVFJ1aU1TMTlIZDRBTU1oOTdpQXVRbkpUVC8vampmTkd5ZVROYno5UE9UT3VmaHQvQSs5NWY2UWNsUDdRY2tBdFhodlFXYjNpQW9Yb3BwU2ZxaFh4MGwrTElCTFZiZXJsNXBsUlpLdTIzd0J0UnpRVWZ3RzJWb3piU2pIdGMxbXVmWkxUaElIaWpUR2wwaVZzVnhwcVdiVENnamZUUWI0VGtYUk9EZkgrYnBOenpNay9oM3F0SnBVTDkyQUV5ZXVoYzB2aUE3MzZnWVh3YzhnUlB1V1RlN1JwczdSSWJFMjhrUXFEWmNUazc4eURDd2REdlp6ckZ5S0NaYTE5YkkrZi9Ddkk1K3pqQWh4TWt4RG1Dd3JlYnZ5RHF6dFhNcHpzcXcvTWpUeTY1SXFCRVJYdThxNzl6UFUxZlNCNWphOUhQUHZxWmRJN2k1bGk1dDNGOWNJUWhVK1FLTEU3QjlHSVJQUVZjdXhkSGhUeGpHN3JtY2t1L1FiQXVQcG14Wlo1YzQ1ckJMU05ubnVTRUt2SGFBT3o2WjVxR2JNZEJmclNpMGFsSU1JMmJDK0NMVS9tWS9RbFhyTmUyYlNNTlJPeTlHNXlDNWEzUmsrWWJZejc4K1NXb05kZnhmKzlXYTV0SGlrcThHOVpnRDhtMmhlT1hRdnhWVWYvSUtjMXg0TEUrZThxdjZZa3Mxc05aazRPUXFoUlRuRlB1aEd1Qzg4VWJWeXc1ZVdJWHZXTTNuYlpHTVFaOFR0RjZjQU1laUhkMnJja0pFKzZHRkNhODB6NGVTc3ZzTkduN3Nac1h2Nm1naHVUcFVFY0JYZFRscXZlaEJidVdmZEZzelNOeUNhbXNJSFVPNTI3MThLSWpjalNrajFFTGxxZkRaa3NaSVJaaUFyMTRhYTYxTnhUOGIzUGY5RW4xM2tPUzJoZEV1RkFnejNXT1RlOUhocDkyOUNGTkhtQWF5UUxTdmMxNk9xMWxzcnJ5dE9VYnB1eHFLM1RIZkhVcjlTV29MK2RheHpWN05yejVwV2U1RVFYNmVkUmdiWC8vdUZhZkZjaW1RRTRaQlo2SnNSZHZCM1hnTUZzaGRtdlJBS1RRY1F2dUY2b1IvcE9sV0pSbEdsTGtLb1ZRajBuNTFDMUhIVVl3Y2dOcUZqUHdGYW9EVHdvMnFrR0h5d0JXQzlMRElMQWpIQ2IyTnBFendCV3VNREErcnhSRDJ6VGcxUjUza3AzZ2tkMlBrQy9YQXZtNXF3cVF0YkRBTXNjYnVKMU8ya0ZZdjRVcE05WVhLZUE5K1l4V1RCd0ZQWklSRHhreXdWKzNKbkxYSTNBcW9YTEJ2RjhsUVIwbzYzNlhac0FIWlJ5a2Fac25aM3lIbXlaY0E0VThpSzNZd3AxYlF3SEZadW5rLzE3KzhwdmxsVnNJSXd5cjc1M1NZZkZRTG5KMTNKblVPa3puYmpNZDNwSHAxNXlVdHNpZHJFYVRHdDhrUHpKUVZHbFhqbGo1czRNTmxENGRrejNhOGVqUEgyaTRwcy96Mzl0U3hTQjdrMW1BTjFYUkFXVGtjejlQdUU5dFpuQ1dJN25tTDl4b3pNMXk3Sm1uSDFaQWVXTitGTHVQdE1UT0F0MDhkbVVrS2ZRQUEvakVXcmdIYjJyUjNnajdlb2dDTy9yZ1FWVmgxR0E5Qk43enppYzNCNGtISzRpdHVLUyt0WlRUcFEzdzNYYXNMTjY3eC9YMXdjalhmTjBpdnJ2UVNLQ2o1QWNOb3hURDVzbnEwOG1NRjhMRFNzVlhkSVNObVpYYjJIa2tiMUI3UnVnMCtxUjRqVVJpSEttd0gyOTZ5dWhmRWl1RUhWRVF1OFRkc0Vlb0ZlRk12Y1pyakdkbWRLa3RLWllaOXpvQVhRcmJ5WEhPTC9oSVlqWjZtZEs5bGFiZzE3N0lndUdtQTVvSmZ1QStSc1B0RDVVczg0T2tQcFl6eWEyR0hQajUyc2gwU0NRaEgzYzlzalRkYldoWjh4QUQ5RXBLZHpKS3pJTUIwOGZ6TnlaYzVLdHN4c0Fyd1M2bmF2dy9tQTJ3dkpzWHRXWHVQaXRrTWZFWGpOREMvZXNhUm1vRkg5d2JjdmlSRnBHZHlDRmovSkpSNEt2S293ckxDU1BFMWhhU0xFUE14SlRBakJna3Foa2lHOXcwQkNSVXhGZ1FVSExkb2syNW9yRE45MWo4bzQ5SE9xMHVQdlQ0d1FUQXhNQTBHQ1dDR1NBRmxBd1FDQVFVQUJDRGtuNlc3ZjdOV3dpK1kzZXFock5IVkxocHBmVzM1Z3A5Vittd3JGM0tDZHdRSUJGRHRCbTlUbUlNQ0FnZ0E=" | base64 --decode > /tmp/apple_cert.p12  # Replace CERT_BASE64_PLACEHOLDER with your base64 string

      - name: Check decoded certificate file
        run: |
          ls -l /tmp/apple_cert.p12
          file /tmp/apple_cert.p12 || echo "File type check failed - may not be a valid PKCS12 file"

      - name: Import certificate
        run: security import /tmp/apple_cert.p12 -P "$P12_PASSWORD" -A -t cert -f pkcs12 -k $KEYCHAIN_PATH
        continue-on-error: false 

      - name: Verify signing identities
        run: security find-identity -v -p codesigning $KEYCHAIN_PATH

      - name: Download provisioning profile
        run: echo "TUlJdml3WUpLb1pJaHZjTkFRY0NvSUl2ZkRDQ0wzZ0NBUUV4Q3pBSkJnVXJEZ01DR2dVQU1JSWZtQVlKS29aSWh2Y05BUWNCb0lJZmlRU0NINFU4UDNodGJDQjJaWEp6YVc5dVBTSXhMakFpSUdWdVkyOWthVzVuUFNKVlZFWXRPQ0kvUGdvOElVUlBRMVJaVUVVZ2NHeHBjM1FnVUZWQ1RFbERJQ0l0THk5QmNIQnNaUzh2UkZSRUlGQk1TVk5VSURFdU1DOHZSVTRpSUNKb2RIUndPaTh2ZDNkM0xtRndjR3hsTG1OdmJTOUVWRVJ6TDFCeWIzQmxjblI1VEdsemRDMHhMakF1WkhSa0lqNEtQSEJzYVhOMElIWmxjbk5wYjI0OUlqRXVNQ0krQ2p4a2FXTjBQZ29KUEd0bGVUNUJjSEJKUkU1aGJXVThMMnRsZVQ0S0NUeHpkSEpwYm1jK1FuSjFZbUZyWlhJZ1NHOXRaU0JCY0hBOEwzTjBjbWx1Wno0S0NUeHJaWGsrUVhCd2JHbGpZWFJwYjI1SlpHVnVkR2xtYVdWeVVISmxabWw0UEM5clpYaytDZ2s4WVhKeVlYaytDZ2s4YzNSeWFXNW5Qa1F5T1RaVE5EWlVSa004TDNOMGNtbHVaejRLQ1R3dllYSnlZWGsrQ2drOGEyVjVQa055WldGMGFXOXVSR0YwWlR3dmEyVjVQZ29KUEdSaGRHVStNakF5TlMwd09DMHlORlF4Tmpvek1Ub3dNVm84TDJSaGRHVStDZ2s4YTJWNVBsQnNZWFJtYjNKdFBDOXJaWGsrQ2drOFlYSnlZWGsrQ2drSlBITjBjbWx1Wno1cFQxTThMM04wY21sdVp6NEtDUWs4YzNSeWFXNW5Qbmh5VDFNOEwzTjBjbWx1Wno0S0NRazhjM1J5YVc1blBuWnBjMmx2Yms5VFBDOXpkSEpwYm1jK0NnazhMMkZ5Y21GNVBnb0pQR3RsZVQ1SmMxaGpiMlJsVFdGdVlXZGxaRHd2YTJWNVBnb0pQR1poYkhObEx6NEtDVHhyWlhrK1JHVjJaV3h2Y0dWeVEyVnlkR2xtYVdOaGRHVnpQQzlyWlhrK0NnazhZWEp5WVhrK0Nna0pQR1JoZEdFK1RVbEpSblZVUTBOQ1MwZG5RWGRKUWtGblNWRmtVRnBUZDNVMmJFMUJWVkpKZVVKNU1HRkVWRmRxUVU1Q1oydHhhR3RwUnpsM01FSkJVWE5HUVVSQ01VMVZVWGRSWjFsRVZsRlJSRVJFZEVKalNFSnpXbE5DV0dJelNuTmFTR1J3V2tkVloxSkhWakphVjNoMlkwZFdlVWxHU214aVIwWXdZVmM1ZFdONVFrUmFXRW93WVZkYWNGa3lSakJoVnpsMVNVVkdNV1JIYUhaamJXd3daVlJGVEUxQmEwZEJNVlZGUTNkM1ExSjZUWGhGZWtGU1FtZE9Wa0pCYjAxRGEwWjNZMGQ0YkVsRmJIVlplVFI0UTNwQlNrSm5UbFpDUVZsVVFXeFdWRTFDTkZoRVZFa3hUVVJuZVU1RVJUSk5WRlYzVFd4dldFUlVTVEpOUkdkNVRrUkZNazFVVlhkTlZtOTNaMXBSZUVkcVFWbENaMjlLYTJsaFNtc3ZTWE5hUVVWQ1JFRndSVTFxYXpKVmVsRXlWa1ZhUkUxVWIzZFBRVmxFVmxGUlJFUkVSbkJWUjJoMlltMVZaMUpIYkhwa1NFcHdXVzVXTUdGWE9YVlBhVUpZWVZkNGMySXlaMmRSYmtveFdXMUdjbHBZU1dkTFJWRjVUMVJhVkU1RVdsVlNhMDF3VFZKTmQwVlJXVVJXVVZGTVJFRndSVTFxYXpKVmVsRXlWa1ZhUkUxU1ozZEdaMWxFVmxGUlMwUkJPVmhoVjNoellqSm5aMUZ1U2pGWmJVWnlXbGhKZUVONlFVcENaMDVXUWtGWlZFRnNWbFJOU1VsQ1NXcEJUa0puYTNGb2EybEhPWGN3UWtGUlJVWkJRVTlEUVZFNFFVMUpTVUpEWjB0RFFWRkZRWFZFUzFsbGQzb3lPR2g0Vkd4QmJXTnRaRXBaVTBzelRVWndUR1IzU2xKRVNFcHBOVXBHUlRKaVMzTTBhSE5ZVlhSbWFFaE5TV3N4YTFSclJFeENjMWRpVm0wMVFYcFVZbXBUVWxKMVNrMVJaM1ZJYlVSVE1HVllVbVJNVDNSaU5rbE5NbEpLVld4c016aFNjMVZ2ZUU5NlVuQXZNRFJ0VHpKVVZtWXdiMUpMVXpOTlNFOUNjbWxSTlhwWVpIUllNVE5WYnpkR1ExQkhNV2xWY1hKQ1R6aFlORTVaVFVKWmNETTVPUzl0Y25SWWRDOTJaRWtyUzFjd1JtMTZVVlJyT0dONWREbFpjMUZoZWl0c1MwRlFiMDAyWlU5Mk1HeFVWVU5pT0RsS1NrdGxhR2RIWkU1TGFXMUtkRmx6V0dWSlJrMVdZa1poYVcxUmRpOTJRMk50VEUxblIyVnZSMGszZW1remVXNTNURVpJYzNOTFp6UnVjVll5Y0VsdGRXVnBObEJZUWpsS1FXSmphVlJOUldoM1JqbDVNRnB4Y3pKWWJqUkZWVFJqYkV0bWNWTmpVbU5NU1VkbmFVSTJUa2h6UlcxcFpXOUtVVWxFUVZGQlFtODBTVU5KZWtORFFXZzRkMFJCV1VSV1VqQlVRVkZJTDBKQlNYZEJSRUZtUW1kT1ZraFRUVVZIUkVGWFowSlJTaTl6UVZaclVHMTJXa0Z4VTBWeWEyMUxSMDFOYkN0NWJuTnFRbmRDWjJkeVFtZEZSa0pSWTBKQlVWSnJUVWRKZDB4UldVbExkMWxDUWxGVlNFMUJTMGRKVjJnd1pFaEJOa3g1T1dwYVdFb3dZM2sxYUdOSVFuTmFVelZxWWpJd2RtUXpaR3RqYldONlRHMVNiR05xUVhoQ1oyZHlRbWRGUmtKUlkzZEJXVmxzWVVoU01HTkViM1pNTWpscVl6TkJkVmxZUW5kaVIxVjFXVEk1ZEV3eU9XcGpNMEYzVFhreE0yUXlVbmxhZWsxM1RXcERRMEZTTkVkQk1WVmtTVUZUUTBGU1ZYZG5aMFZTVFVsSlFrUlJXVXBMYjFwSmFIWmthbHBCVlVKTlNVZ3ZUVWxJUkVKblozSkNaMFZHUWxGalEwRnFRMEowWjNsQ2N6RktiR0pIYkdoaWJVNXNTVWM1ZFVsSVVtOWhXRTFuV1RKV2VXUkhiRzFoVjA1b1pFZFZaMWx1YTJkWlZ6VTFTVWhDYUdOdVVqVkpSMFo2WXpOV2RGcFlUV2RaVjA1cVdsaENNRmxYTldwYVUwSjJXbWxDTUdGSFZXZGtSMmhzWW1sQ2FHTklRbk5oVjA1b1dXMTRiRWxJVGpCWlZ6VnJXVmhLYTBsSVVteGpiVEY2U1VkR2RWcERRbXBpTWpWcllWaFNjR0l5TlhwSlJ6bHRTVWhXZWxwVGQyZFpNbFo1WkVkc2JXRlhUbWhrUjFWblkwYzVjMkZYVGpWSlIwWjFXa05DYWxwWVNqQmhWMXB3V1RKR01HRlhPWFZKU0VKNVdWZE9NR0ZYVG14SlNFNHdXVmhTYkdKWFZuVmtTRTExVFVSalIwTkRjMGRCVVZWR1FuZEpRa1pwZEc5a1NGSjNZM3B2ZGt3elpETmtlVFZvWTBoQ2MxcFROV3BpTWpCMldUSldlV1JIYkcxaFYwNW9aRWRXYUdSWVVtOWlNMHB3WkVocmRrMUNXVWRCTVZWa1NsRkZRaTkzVVUxTlFXOUhRME56UjBGUlZVWkNkMDFFVFVJd1IwRXhWV1JFWjFGWFFrSlVNVGw0THpaaVRXeFZPVkZVVjA5c09UaE1ValJFVmxFMmMzSnFRVTlDWjA1V1NGRTRRa0ZtT0VWQ1FVMURRalJCZDBWM1dVdExiMXBKYUhaa2FscEJXVUpDUVVWQ0wzZFJRMEpSUVhkRVVWbEtTMjlhU1doMlkwNUJVVVZNUWxGQlJHZG5SVUpCUlVKNGFISTFPRkJ6UW5oalNtVk9kakZMYjJKdmFuVXdUemxXTmpsM2JubFFNSFZJZFZaVWMyVTJWMHhvZUdKbWVtOXRlREZMU0Zac01GcHhLemRWTTNNMFlYUXllbEZ1U1VGM1pHeE1WRXR6Um1WR1NrZ3pSa3hKZEZaVlFuZE9Va3h1UVhOWVdtUk9la00zWmsxT1RHdEZRVGx3VjNkT1Mzb3lVRGhFTVRWb1ltNVFNVFpMU1daRVNWaGlWM2RRV1dONk5FaHphVVpXYzJSSlFVRlhUMWQ0UWpka1NVSjRhMnRQYm1wVFJsbHdaalpzWVZKTlNqaGxPSEFyU1ZoSllXaGxVbWcyVWt4VmJEUkhWRm8zWTAxMWNtbGhaRXRTTm1wWGFVdDVRbk55VWtScU1DOVBka3hSTTIxTGVWUjFSRXQ0VTI1V1JFWjRSRFZIYVRjdlNtWnNkMjVuYm1oMFlqUm9lalp6UlROcE5tTkVkamRwWTIwelowcDVZMHBFUVZGaFRURm1SMjRyTlRnelQwRjBVMlV2TTJ0MGFrZEZaamRKWldOaUt6WndVazlKVnpCR0wxUkpUR2R4YkRWcFFqUTRjMnRKUFR3dlpHRjBZVDRLQ1R3dllYSnlZWGsrQ2dvSlBHdGxlVDVFUlZJdFJXNWpiMlJsWkMxUWNtOW1hV3hsUEM5clpYaytDZ2s4WkdGMFlUNU5TVWxPVUZGWlNrdHZXa2xvZG1OT1FWRmpRMjlKU1U1TWFrTkRSRk52UTBGUlJYaEVla0ZPUW1kc1oyaHJaMEphVVUxRlFXZEZSa0ZFUTBOQmRsbEhRMU54UjFOSllqTkVVVVZJUVdGRFEwRjFZMFZuWjB4cVRWbEpRek42UVUxRVFXUlhXbGhLZW1GWE9YVkJaMFZDVFVFd1RVTkdRbEZWVlU1dldsZE9ja0ZSUlVGTlFrRk5RMnhTY0dKWFZsVmlNSGh3WkcxVlEwRm5Sbk5OUWsxTlJHdHNlbGRIVG5aYVIxWk9XVmMxYUZveVZtdEJVVVZCVFVKelRVTkdVbXhaVnpGUFdWY3hiRVJCT1ZoaFYzaHpZakpuWjFGdVNqRlpiVVp5V2xoSmQwaFJkMDFSTTBwc1dWaFNjR0l5TlVWWldGSnNSbmN3ZVU1VVFUUk5hbEY0VG1wTmVFMUVSbUZOUWpSTlExVkdkMk5GYkVWVWJVWjBXbEYzVWxGdVNqRlpiVVp5V2xoSloxTkhPWFJhVTBKQ1kwaEJkMGhuZDA5V1IxWm9ZbFZzYTFwWE5UQmhWMXB3V2xoSmQwUkJkMHRTUkVrMVRteE5NRTVzVWtkUmVrRm1SRUUxUm1WSVFuQmpiVVl3WVZjNWRWSkhSakJhVW1OT1RXcFpkMDlFU1RCTlZGbDRUbFJCZUZkcVFXZEVRbVJSWTIwNWJXRlhlR3hTUjJ4NlpFaEtjRmx1VmpCaFZ6bDFWa2hzZDFwUmQwWlZNVkpRVld0VmQwbFJkMGxWUjNob1pFZGFkbU50TUhkR1VYZEVZVlU1VkVSQlVqUmphemxVUkVGb01tRllUbkJpTWpWUVZYcEJiRVJCVWs5WlZ6RnNSRUl4UTJOdVZtbFpWM1JzWTJ0b2RtSlhWa0pqU0VKbVVWaENkMVV6VW5aamJWWm1aR3BGZFUxRVFYSkVRblJDWTBoQ2MyRlhUbWhrUjJ4MlltdHNhMXBYTlRCaFYxcHdXbGhLVVdOdFZtMWhXR2QzUkVGM1MxSkVTVFZPYkUwd1RteFNSMUY2UVhORVFWSldWbFZzUlVSRFVYcE9WRTAxV2xkS2JVNURNRE5hUjFGNlRGUlJNMDV0UlhSWmFsSnRUV2t4YVZsVVJtbE9SMFUwVG5wSmQwNVVTWGRQZDNkV1VrZFdNbHBYZUhaalIxWjVVVEpXZVdSSGJHMWhWMDVvWkVkV2VrMURTVVZKUWtOb2QyMVRVbWREUW1rMFR5OURiRnBUZDAwM2RXUTROa0Y2UlV4M1VWUk5iMXBNT1V0YWVVcERTRTFKU0RORVFYaEdZbTVTY0dSSGVHeGlWMVoxWkVoT2QyZGxXVU5CVVVkM1oyVkJkMUZSZDFkWldFSjNZa2RzYWxsWVVuQmlNalIwWVZkU2JHSnVVbkJhYld4c1kyZDNibEpFU1RWT2JFMHdUbXhTUjFGNU5XcGlNakIxV1c1S01WbHRSbkphV0VsMVdXNUtNVmx0Um5KYVdFcEpZakl4YkZsWVFuZE5RbWROUlRKS2JHUkhSWFJqYlZaM1lqTktNR041TVdoWk0xSndaRzFWUWtGbU9IZE5VWGRxV1RJNWRFeHRSbmRqUjNoc1RHMVNiR1J0Vm5OaU0wSnNZMmsxTUZwWFJuUk1WMnhyV2xjMU1HRlhXbkJhV0VsTlEydFJlVTlVV2xST1JGcFZVbXROZDBWM2QwOWFNbFl3VEZoU2FHTXljM1JaVjNoellqTmpRa0ZSUVhkUFVYZFhZVEpXTlZreWFHaGhWelIwV1ZkT2FscFlUbnBNVjJSNVlqTldkMk42UVdaRVFYaEZUV3ByTWxWNlVUSldSVnBFVEdsdlRVUXlUblppVXpWb1kwaENjMXBUTlRCaU1uUnNZbkZEUTBORWQzZG5aMHBFVFVsSlFubGhRVVJCWjBWRFFXZG5kSGhtZVVrd2MxWk1iRlJCUzBKblozRm9hMnBQVUZGUlJFRjZRbTVOVW5OM1IxRlpSRlpSVVVSRVFrcENZMGhDYzFwVFFsTmlNamt3U1VWT1FrbERNR2RTZWsxNFNtcEJhMEpuVGxaQ1FYTk5TRlZHZDJOSGVHeEpSVTVzWTI1U2NGcHRiR3BaV0ZKd1lqSTBaMUZZVmpCaFJ6bDVZVmhTTlUxU1RYZEZVVmxFVmxGUlMwUkJjRUpqU0VKeldsTkNTbUp0VFhWTlVYTjNRMUZaUkZaUlVVZEZkMHBXVlhwQlpVWjNNSGhPUkVFd1RYcEJlRTlFUlRWTlJGcGhSbmN3ZWs5VVFUQk5la0Y0VDBSRk5VMUVXbUZOUjJONFIzcEJXa0puVGxaQ1FVMU5SV3RHZDJOSGVHeEpSa3AyWWpOUloxRXdSV2RNVTBKSVRYcEZiVTFEVVVkQk1WVkZRM2QzWkZGWVFuZGlSMVZuVVRKV2VXUkhiRzFoVjA1b1pFZHNkbUpwUWtKa1dGSnZZak5LY0dSSWEzaEZla0ZTUW1kT1ZrSkJiMDFEYTBaM1kwZDRiRWxGYkhWWmVUUjRRM3BCU2tKblRsWkNRVmxVUVd4V1ZFMUlXWGRGUVZsSVMyOWFTWHBxTUVOQlVWbEdTelJGUlVGRFNVUlpaMEZGYlU5cmRsQlZRbmx3VHpKVVNXNUxRa1Y0ZW1SRlNsaDRlR0ZPVDJOa2QxVkdkR3RQTldGWlJrdHVaR3RsTVRsUFQwNVBOMGhGVXpGbUwxVm1kR3BLYVZoamJuQm9SblJRVFVVNFVsZG5SRGxYUm1kTmNHWlZVRXhGTUVoU2VFNHhNbkJsV0d3eU9IaFlUekJ5YmxoelowODVhVFZXVG14bGJXRlJObFZSYjNodk1FbDNVVVJCWkVKblRsWklVVFJGUm1kUlZYVTNSR1Z2Vm1kNmFVcHhhMmx3Ym1WMmNqTnljamx5VEVwTGMzZEVkMWxFVmxJd1ZFRlJTQzlDUVZWM1FYZEZRaTk2UVU5Q1owNVdTRkU0UWtGbU9FVkNRVTFEUVZGWmQwTm5XVWxMYjFwSmVtb3dSVUYzVFVSaFFVRjNXbEZKZUVGSlVIQjNZMUZYV0dod1pFNUNhbG8zWlM4d1lrRTBRVkpyZFRRek4wcEhSV05WVUM5bFdqWnFTMGR0WVRnM1EwRTVVMk01V2xCSFpFeG9jVE0yYjJwR1VVbDNZbGRoUzBWTmNsVkVaRkpRZWxreFJGQnlVMHRaTmxWNlluVk9kREpvWlROYVFpOUpWWGxpTldsSFNqQlBVWE5ZVnpoMFVuRkJlbTlIUVZCdWIzSkpiMDFKU1VNMWFrTkRRVzB5WjBGM1NVSkJaMGxKVFhjemRTdE1PVTFoUXpSM1EyZFpTVXR2V2tsNmFqQkZRWGROZDFwNlJXSk5RbXRIUVRGVlJVRjNkMU5SV0VKM1lrZFZaMVZ0T1haa1EwSkVVVk5CZEVsRlkzcE5VMWwzU2tGWlJGWlJVVXhFUWpGQ1kwaENjMXBUUWtSYVdFb3dZVmRhY0ZreVJqQmhWemwxU1VWR01XUkhhSFpqYld3d1pWUkZWRTFDUlVkQk1WVkZRMmQzUzFGWVFuZGlSMVZuVTFjMWFreHFSVXhOUVd0SFFURlZSVUpvVFVOV1ZrMTNTR2hqVGsxVVkzZE5ha2w1VFdwSmVVMTZTWGxYYUdOT1RYcEpkMDFxUlRSTlJFRjNUVVJCZDFkcVFubE5VMWwzU2tGWlJGWlJVVVJFUWpGQ1kwaENjMXBUUWxSbFdFNHdXbGN3WjFOWE5UQmFWMlI1V1ZoU2NHSXlOR2RSTUVWblRrUkZiVTFEVVVkQk1WVkZRM2QzWkZGWVFuZGlSMVZuVVRKV2VXUkhiRzFoVjA1b1pFZHNkbUpwUWtKa1dGSnZZak5LY0dSSWEzaEZla0ZTUW1kT1ZrSkJiMDFEYTBaM1kwZDRiRWxGYkhWWmVUUjRRM3BCU2tKblRsWkNRVmxVUVd4V1ZFMUdhM2RGZDFsSVMyOWFTWHBxTUVOQlVWbEpTMjlhU1hwcU1FUkJVV05FVVdkQlJVSnRkV3RXYlRrNWJubG1VbnBxWVU5cmFIUlhlbFpSTWxwRmNrcHNSMmxhSzNOcloyWjFUREZYUVM5ak5HMXlja2RWWTNaTWRUZzNjRUZITUVGU1RrVm1SbTl0Y21GRFkwdFRWMHMxWlZsSFlqQTVPRmR4VDBJNWVrTkNPVVJCVUVKblRsWklVazFDUVdZNFJVSlVRVVJCVVVndlRVSTRSMEV4VldSSmQxRlpUVUpoUVVaTWRYY3pjVVpaVFRScFlYQkpjVm96Y2pZNU5qWXZZWGw1VTNKTlJWbEhRME56UjBGUlZVWkNkMFZDUWtSdmQwOUVRVEpDWjJkeVFtZEZSa0pSWTNkQldWbHhZVWhTTUdORWIzWk1NamxxWXpOQmRWbFlRbmRpUjFWMVdUSTVkRXd5T1dwak0wRjNUWGt4YUdOSVFuTmFXRXAyWWpOU2FsbFhZM3BOUkdOSFFURlZaRWgzVVhkTlF6UjNURXRCY1c5RGFVZEtiV2d3WkVoQk5reDVPV3BqYlhkMVdWaENkMkpIVlhWWk1qbDBUREpHZDJOSGVHeGpiVGwyWkVkT2FGcDZUWFZaTTBwelRVSXdSMEV4VldSRVoxRlhRa0pTTmxJM2J6UnBhRlZyVTBOS1IzcGlObEJIYVZJM1RrRk5jV0ZVUVU5Q1owNVdTRkU0UWtGbU9FVkNRVTFEUVZGWmQwVkJXVXRMYjFwSmFIWmthbHBCV1VORlVWRkRRbEZCZDBObldVbExiMXBKZW1vd1JVRjNUVVJhZDBGM1drRkpkMFpSZVhCcWMyRjJiRzFzY25BMUwyUllUbEZFVjFkNWRWVjBVbWQ0YjNReU5FeG1SbTkyUlVwbVQwTmhOREoxZURRemQzaDRRMlEyY0RRMlNpOWhkRE5CYWtKb1RYbEVlRXRtTHpWb2VrdDFTMk5vYTFCWVdqZFZZVlJUUVdrNU1uWnRRV2xyWmtoV1QyNVlZM1JQVEVkTGNHSXJlR2R1WTFOckwxWktVRVE0ZVhKSmQyZG5UVWhOU1VsRGNtRkJSRUZuUlVOQloyZFlaMHRuTUZwdFZIRjVla0ZMUW1kbmNXaHJhazlRVVZGRVFXcENlVTFUV1hkS1FWbEVWbEZSUkVSQ01VSmpTRUp6V2xOQ1ZHVllUakJhVnpCblUxYzFNRnBYWkhsWldGSndZakkwWjFFd1JXZE9SRVZ0VFVOUlIwRXhWVVZEZDNka1VWaENkMkpIVldkUk1sWjVaRWRzYldGWFRtaGtSMngyWW1sQ1FtUllVbTlpTTBwd1pFaHJlRVY2UVZKQ1owNVdRa0Z2VFVOclJuZGpSM2hzU1VWc2RWbDVOSGhEZWtGS1FtZE9Wa0pCV1ZSQmJGWlVUVUkwV0VSVVNUQk5WRVY1VFVSQmVrMXFRVEJPVm05WVJGUkpORTFVU1hoT1JFVTBUVVJCZWsxR2IzZFVha1Z4VFVOblIwRXhWVVZCZDNkb1ZqRmtSVlZwUWxGamJUa3lZVmhPY0dJeU5YQmliV05uVlVoS2RscHRiSE5hVTBKVVlWZGtkV0ZYTlc1TlVrMTNSVkZaUkZaUlVVdEVRWEJDWTBoQ2MxcFRRa3BpYlUxMVRWRnpkME5SV1VSV1VWRkhSWGRLVmxWNlFscE5RazFIUW5seFIxTk5ORGxCWjBWSFEwTnhSMU5OTkRsQmQwVklRVEJKUVVKUVYxVlhkemRDTVVaUkwwZGtOVWRaUTFabVVHODBjSG95ZUZCck9WVmpkRE15TWxWc09HWTBablJxUVdKTFEwYzJhV2hVY2xSVU4yVTVWM1ZTWmxWdFRURm5kRGcxVDNGaVl6WldNMXBVTmtST1JISXpNbXBuWjBaUVRVbEpRbE42UVUxQ1owNVdTRkpOUWtGbU9FVkJha0ZCVFVJNFIwRXhWV1JKZDFGWlRVSmhRVVpJY0VoMWFtbExSbE5TU1VscllrNTJiemhoU2toek1FRjVjSEJOUlVWSFEwTnpSMEZSVlVaQ2QwVkNRa1JWZDAxNlFYaENaMmR5UW1kRlJrSlJZM2RCV1Zsc1lVaFNNR05FYjNaTU1qbHFZek5CZFZsWVFuZGlSMVYxV1RJNWRFd3lPV3BqTTBGM1RYa3hhR015YkdwWlZGRjNUWHBEUW14bldVUldVakJuUWtsSFQwMUpSMHhOU1VkSlFtZHJjV2hyYVVjNU1rNXJRbEZGZDJWNlFqVkNaMmR5UW1kRlJrSlJZME5CYWtKMFJFZDBWV0ZIYkhwSlIwNXNZMjVTY0ZwdGJHcFpXRkpzU1Vkc2VrbElVblpKUjBwc1NVaFdlbHBYVVdkYVdHaHFZa2hXZW1GWVdteGlTR3RuV20wNWVVbEhXakZpYlU0d1lWYzVkV041UW5CaWJsSnNZMjAxYUdKRFFqQmllVUpDWTBoQ2MxcFRRbEZqYlRsclpGZE9NR041UW1oaWJWRjJZak5KWjFGWVFuZGlSMVZuWTBoS2Rsa3lWbnBqTWxaNlRHcEJaRUpuVGxaSVVUUkZSbWRSVlRaV1RFOUVZa1JIYVVKd2JGTnlhV0pGV1M5NE0wSTFTRVpJZDNkRVoxbEVWbEl3VUVGUlNDOUNRVkZFUVdkbFFVMUJPRWREVTNGSFUwbGlNMWt5VVUxRmQxRkRRbEZCZDBObldVbExiMXBKZW1vd1JVRjNTVVJUUVVGM1VsRkphRUZQSzJGMlJqSm5WMjFhYzFwTWJrNU9OVTl3VlRkUk0zaGpaSE0wV1ZBMlJuaHlaVU42TTFkeE1taHRRV2xDTkVrNWJrUnBRV1JLVUdaWU4ybFpLMUZpYkdwblZqVTVhaTh4YW1neGJ6bGpiVWRRVjA5cU5DOXVWRWREUVdSbmQyZG5TRlZCWjBWQ1RVZzBkMk5xUlcxTlExRkhRVEZWUlVGM2QyUlJXRUozWWtkVloxVXpiSHBrUjFaMFNVVnNkV1JIVm01amJVWXdZVmM1ZFVsRlRrSkpSRkY0U21wQmEwSm5UbFpDUVhOTlNGVkdkMk5IZUd4SlJVNXNZMjVTY0ZwdGJHcFpXRkp3WWpJMFoxRllWakJoUnpsNVlWaFNOVTFTVFhkRlVWbEVWbEZSUzBSQmNFSmpTRUp6V2xOQ1NtSnRUWFZOVVhOM1ExRlpSRlpSVVVkRmQwcFdWWGRKU1VZMFEyOU9SMXByTm5OemQwUlJXVXBaU1ZwSlFWZFZSRUpCU1VKQ1VVTm5aMlZyZDBkQldVcExiMXBKYUhaalRrRlJhMFJOVVhOSFExTnhSMU5KWWpORVVVVklRVlJCWTBKbmEzRm9hMmxIT1hjd1FrTlJWWGhFZUdOT1RXcFZkMDlFU1RCTlZGbDZUVlJCZVZkcVFYRkNaMnR4YUd0cFJ6bDNNRUpEVkZGNFNGUkJZazFCTUVkRFYwTkhVMEZHYkVGM1VVTkJVVlZCYjFGdlIwTkRjVWRUVFRRNVFrRk5RMDFET0VkRFUzRkhVMGxpTTBSUlJVcENSRVZwUWtORGNsRmxlazU1VkRBMUszZHFZVEpWYlhwWmFGbFJNMjlPVkV0Wk9IWnJOa3R3SzJwTFlucFhOSEo1ZWtKVFFtZHJjV2hyYVVjNWR6QkNRMUU0ZUZKVVFrUk5RVzlIUTBOeFIxTkpZak5FVVUxSVRVRTBSME5EY1VkVFNXSXpSRkZOUTBGblNVRm5SRUZPUW1kbmNXaHJhVWM1ZHpCRVFXZEpRbEZFUVVoQ1oxVnlSR2ROUTBKNlFVNUNaMmR4YUd0cFJ6bDNNRVJCWjBsQ1MwUkJTMEpuWjNGb2EycFBVRkZSUkVGblVrbE5SVmxEU1ZGRWN6Sk5hV3A1T1doM2FqQXJVMU5YV0dWb2JTOU1UMU5yUkM5M2VFWlpRMDV2TVZoWVZWZzRSR2hZWjBsb1FVMWllbFZRTm0xa2RrMUliRVF4TTNSbE4zZ3pla1JQUm1sNlYwMVpSbHBYVVVkRFJYVXdRbnBhWkVjOEwyUmhkR0UrQ2drSkNRa0pDUWtKQ1FrSkNRb0pDUWs4YTJWNVBsQlFVVU5vWldOclBDOXJaWGsrQ2drOFptRnNjMlV2UGdvS0NUeHJaWGsrUlc1MGFYUnNaVzFsYm5SelBDOXJaWGsrQ2drOFpHbGpkRDRLQ1FrOGEyVjVQbUpsZEdFdGNtVndiM0owY3kxaFkzUnBkbVU4TDJ0bGVUNEtDUWs4ZEhKMVpTOCtDZ2tKQ1FrS0NRa0pDVHhyWlhrK1lYQndiR2xqWVhScGIyNHRhV1JsYm5ScFptbGxjand2YTJWNVBnb0pDVHh6ZEhKcGJtYytSREk1TmxNME5sUkdReTVqYjIwdVluSjFZbUZyWlhJdVluSjFZbUZyWlhKSWIyMWxZWEJ3UEM5emRISnBibWMrQ2drSkNRa0tDUWtKQ1R4clpYaythMlY1WTJoaGFXNHRZV05qWlhOekxXZHliM1Z3Y3p3dmEyVjVQZ29KQ1R4aGNuSmhlVDRLQ1FrSkNUeHpkSEpwYm1jK1JESTVObE0wTmxSR1F5NHFQQzl6ZEhKcGJtYytDZ2tKQ1FrOGMzUnlhVzVuUG1OdmJTNWhjSEJzWlM1MGIydGxiand2YzNSeWFXNW5QZ29KQ1R3dllYSnlZWGsrQ2drSkNRa0tDUWtKQ1R4clpYaytaMlYwTFhSaGMyc3RZV3hzYjNjOEwydGxlVDRLQ1FrOFptRnNjMlV2UGdvSkNRa0pDZ2tKQ1FrOGEyVjVQbU52YlM1aGNIQnNaUzVrWlhabGJHOXdaWEl1ZEdWaGJTMXBaR1Z1ZEdsbWFXVnlQQzlyWlhrK0Nna0pQSE4wY21sdVp6NUVNamsyVXpRMlZFWkRQQzl6ZEhKcGJtYytDZ2tKQ2drOEwyUnBZM1ErQ2drOGEyVjVQa1Y0Y0dseVlYUnBiMjVFWVhSbFBDOXJaWGsrQ2drOFpHRjBaVDR5TURJMkxUQTRMVEkwVkRFMk9qRTFPakF4V2p3dlpHRjBaVDRLQ1R4clpYaytUbUZ0WlR3dmEyVjVQZ29KUEhOMGNtbHVaejVDY25WaVlXdGxja2h2YldWQmNIQmZRWEJ3VTNSdmNtVmZkakV1TUR3dmMzUnlhVzVuUGdvSlBHdGxlVDVVWldGdFNXUmxiblJwWm1sbGNqd3ZhMlY1UGdvSlBHRnljbUY1UGdvSkNUeHpkSEpwYm1jK1JESTVObE0wTmxSR1F6d3ZjM1J5YVc1blBnb0pQQzloY25KaGVUNEtDVHhyWlhrK1ZHVmhiVTVoYldVOEwydGxlVDRLQ1R4emRISnBibWMrVjJsc2JHOW9JRUp5ZFdKaGEyVnlQQzl6ZEhKcGJtYytDZ2s4YTJWNVBsUnBiV1ZVYjB4cGRtVThMMnRsZVQ0S0NUeHBiblJsWjJWeVBqTTJORHd2YVc1MFpXZGxjajRLQ1R4clpYaytWVlZKUkR3dmEyVjVQZ29KUEhOMGNtbHVaejR6TlRNNVpXSm1OQzAzWkdRekxUUTNObUV0WWpSbU1pMWlZVEZpTkdFNE56SXdOVEk4TDNOMGNtbHVaejRLQ1R4clpYaytWbVZ5YzJsdmJqd3ZhMlY1UGdvSlBHbHVkR1ZuWlhJK01Ud3ZhVzUwWldkbGNqNEtQQzlrYVdOMFBnbzhMM0JzYVhOMFBxQ0NEVDh3Z2dRME1JSURIS0FEQWdFQ0FnZzlXZmczNnRIWW56QU5CZ2txaGtpRzl3MEJBUXNGQURCek1TMHdLd1lEVlFRRERDUkJjSEJzWlNCcFVHaHZibVVnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hJREFlQmdOVkJBc01GME5sY25ScFptbGpZWFJwYjI0Z1FYVjBhRzl5YVhSNU1STXdFUVlEVlFRS0RBcEJjSEJzWlNCSmJtTXVNUXN3Q1FZRFZRUUdFd0pWVXpBZUZ3MHlOREV5TVRZeE9USXhNREZhRncweU9URXlNVEV4T0RFek5UbGFNRmt4TlRBekJnTlZCQU1NTEVGd2NHeGxJR2xRYUc5dVpTQlBVeUJRY205MmFYTnBiMjVwYm1jZ1VISnZabWxzWlNCVGFXZHVhVzVuTVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1Rc3dDUVlEVlFRR0V3SlZVekNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFOQ1RNYXY0VXg3ZnJSNHZaUGZKVGRlV3ZsOUxQWGxrWEVQdUtjTkEwdm92SEtDMnZCRno3L0Fpc04vZStmbk9WZVAxUWdHMUkyVkJFanYzZkVaOWlSTkZsVVRzbHBWaVpwZVFBd0RaNEs3RjJiR2NJQzJXNElYdGIydlRVdE9EUE5RQkl5WHA1Y2JVRWRoNXFnakMzUlZZOWUrS2swc05TKzROdG9lVGRSRVFWY3NNZUFmYk4zQkdPNWY2eE90NEtlRDA3SGpqWWRwQVY0QUh1NGljcGNkSmJjZ20wNVVmVFNHaWpXaHpneDdtV1ZxRmxsVlVzSlV1SmR4M0RXR0hnWTJKcEFON1BBQjNMSWxxV2ROa1JObDBwVnVLc1ZKaFgyNEVNTlR6NGhBMERKV01TK0Y3MWl1RmcvSW5PWTF3Q0NQaUZJai9rL1F0YlV3bTRvczNoaTBDQXdFQUFhT0I1VENCNGpBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkcveGxSaGlYT0RJOGNYdGJCako0Tk5rVXBnZ01FQUdDQ3NHQVFVRkJ3RUJCRFF3TWpBd0JnZ3JCZ0VGQlFjd0FZWWthSFIwY0RvdkwyOWpjM0F1WVhCd2JHVXVZMjl0TDI5amMzQXdNeTFoYVhCallUQTNNQzhHQTFVZEh3UW9NQ1l3SktBaW9DQ0dIbWgwZEhBNkx5OWpjbXd1WVhCd2JHVXVZMjl0TDJGcGNHTmhMbU55YkRBZEJnTlZIUTRFRmdRVXZMWEY2YjM4eTlDZTNKU3dIdmdobEZ6L0NTNHdEZ1lEVlIwUEFRSC9CQVFEQWdlQU1BOEdDU3FHU0liM1kyUUdPZ1FDQlFBd0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFESTB3dWwzcWwvZ3hzcWk4M2RaNTRwbnVQRlI4L3V3OXBlL3NSR2o0YUU4dXlPUzZSS1RvbkVkdlBHYWNXK2tQRzgya3JiZ1I0S2lrK1BudUkrNzN5VkVZZ0xQemJ6Mys0MktDWEI0WmNJWlRTWExjbUloNUtsbytSQ2FMbm9QS0w2bUF3YlJWV0VmcjN6NGxOUnhEdUxUSlZTTHpxM1ZhQWRidlMxN3gySkZlYm1waDB6NEdEdUFyaEJMY2RoNEsrWUtyNXJuMlUzTTZsdTNvNWRWYSt3Tm9Iakh3TERQeTl3UVREQ1NFM0dVMXEvZzdNbnB5WnZPSlRMdUVRMGhGeVNMOFpVdUltSkdSWC9nMjljV1ZNRzVQdFBhaXJsbDlyUzBJMzk0WGRseWRtUmpwd2hWeDltM2xOc2p2L09UcDlRRVJFTU55dUpXc2l1VUtLUTljb2N3Z2dSRU1JSURMS0FEQWdFQ0FnaGNZOHJrU2pkVHlUQU5CZ2txaGtpRzl3MEJBUXNGQURCaU1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFR0ExVUVDaE1LUVhCd2JHVWdTVzVqTGpFbU1DUUdBMVVFQ3hNZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hGakFVQmdOVkJBTVREVUZ3Y0d4bElGSnZiM1FnUTBFd0hoY05NVGN3TlRFd01qRXlOek13V2hjTk16QXhNak14TURBd01EQXdXakJ6TVMwd0t3WURWUVFERENSQmNIQnNaU0JwVUdodmJtVWdRMlZ5ZEdsbWFXTmhkR2x2YmlCQmRYUm9iM0pwZEhreElEQWVCZ05WQkFzTUYwTmxjblJwWm1sallYUnBiMjRnUVhWMGFHOXlhWFI1TVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1Rc3dDUVlEVlFRR0V3SlZVekNDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFNbEZhZ0VQUG9NRWhzZjh2OXhlOEI2QjdoY3djMk1tTHQ0OWVpVE5rejVQT1VlNmRiN3p3Tkx4V2FLckgvNEtoanpaTFpvSDhnNXJ1U21SR2w4aUNvdnhjbGdGcmt4TFJNVjVwNEE4c0lqZ2pBd25oRjBaNVljWk5zdmp4WGEzc1BSQmNsSDBCVnlEUzZKdHBsRzQ4U2JmZTE2dFpRekdzcGhSakx0OUcwekJUc2dJeDlMdFpBdTAzUnVOVDBCOUc0OUlscEpiODlDWWZ0bThwQmtPbVdHN1FWMEJ6RnQzZW4wazBOelRVLy9EM01XVUxMWmFUWTRZSXptOTJjWlNQdEh5OUNXS29TcUgvZGdNUmlsUi8rMFhiSWtsYTRlL2lta1VuM2Vmd3hXM2FMT0lSYjJFNWdZQ1FXUVByU29vdUJYSjRLeW5pcnB5QkRTeWVJejRzb1VDQXdFQUFhT0I3RENCNlRBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUI4R0ExVWRJd1FZTUJhQUZDdlFhVWVVZGduKzlHdU5Ma0NtOTBkTmZ3aGVNRVFHQ0NzR0FRVUZCd0VCQkRnd05qQTBCZ2dyQmdFRkJRY3dBWVlvYUhSMGNEb3ZMMjlqYzNBdVlYQndiR1V1WTI5dEwyOWpjM0F3TXkxaGNIQnNaWEp2YjNSallUQXVCZ05WSFI4RUp6QWxNQ09nSWFBZmhoMW9kSFJ3T2k4dlkzSnNMbUZ3Y0d4bExtTnZiUzl5YjI5MExtTnliREFkQmdOVkhRNEVGZ1FVYi9HVkdHSmM0TWp4eGUxc0dNbmcwMlJTbUNBd0RnWURWUjBQQVFIL0JBUURBZ0VHTUJBR0NpcUdTSWIzWTJRR0FoSUVBZ1VBTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFBNno2eVlqYjZTSUNFSnJaWHpzVndoK2pZdFZ5QkVkSE5ra2dpemxxejNiWmY2V3pRNEo4OFNSdE04RWZBSHlabVFzZEhvRVFtbDQ2VnJiR01JUDU0bCt0V1puRXptNWM2T3NrMW83SXVybzZKUGloRVZQdHdVS3h6R1JMWnZaOFZiVDVVcExZZGNQOXlESG5kUDdkcFVweTNuRTRIQlk4UlVDeHRMQ21vb0lnalVONUo4ZjJjb1g2ODlQN2VzV1IwNE5HUmE3ak5LR1VKRUtjVEtHR3Zod1ZNdExmUk53aFgyTXpJWWVQRW1iNHBONjVSTW8rai9EN01EaTJYYTZ5N1laVkNmM0orSzN6R29oRlRjVWxKQjBySVRIVEZHUjRoZlB1N0Q4b3dqQkpYcnJJbytnbXdHbnk3amkwT2FZbHMwRGZTWnp5enV1bktHR1NPbC9JNjFNSUlFdXpDQ0E2T2dBd0lCQWdJQkFqQU5CZ2txaGtpRzl3MEJBUVVGQURCaU1Rc3dDUVlEVlFRR0V3SlZVekVUTUJFR0ExVUVDaE1LUVhCd2JHVWdTVzVqTGpFbU1DUUdBMVVFQ3hNZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hGakFVQmdOVkJBTVREVUZ3Y0d4bElGSnZiM1FnUTBFd0hoY05NRFl3TkRJMU1qRTBNRE0yV2hjTk16VXdNakE1TWpFME1ETTJXakJpTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNoTUtRWEJ3YkdVZ1NXNWpMakVtTUNRR0ExVUVDeE1kUVhCd2JHVWdRMlZ5ZEdsbWFXTmhkR2x2YmlCQmRYUm9iM0pwZEhreEZqQVVCZ05WQkFNVERVRndjR3hsSUZKdmIzUWdRMEV3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRRGtrYWtKSDVIYkhrZFE2d1h0WG5tRUxlczJvbGRNVmV5TEdZbmUrVXRzOVFlcklqQUM2QmcrK0ZBSjAzOUJxSmo1MGNwbW5DUnJFZENqdStRYktzTWZsWjU2REtSSGkxdlVGamN6eThRUFRjNFVhZEhKR1hMMVhRN1ZmMStiOGlVRHVsV1BUVjBOOFdRMUl4VkxGVmtkczVUMzlweWV6MUM2d1ZoUVo0OEl0Q0QzeTZ3c0lHOXd0ajhCTUl5M1E4OFBuVDN6SzBrb0dzait6clc1RHRsZUhOYkxQYlU2cmZRUERnQ1NDN0VoRmk1MDFUd04yMklXcTZOeGtrZFRWY0d2TDBHeitQdmpjTTNtbzB4RmZoOU1hMUNXUVluRWRHSUxFSU5CaHpPS2diRXdXT3hhQkRLTWFMT1BIZDVsYy85blhtVzhTZGgybnpNVVphRjNsTWt0QWdNQkFBR2pnZ0Y2TUlJQmRqQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFRmdRVUs5QnBSNVIyQ2Y3MGE0MHVRS2IzUjAxL0NGNHdId1lEVlIwakJCZ3dGb0FVSzlCcFI1UjJDZjcwYTQwdVFLYjNSMDEvQ0Y0d2dnRVJCZ05WSFNBRWdnRUlNSUlCQkRDQ0FRQUdDU3FHU0liM1kyUUZBVENCOGpBcUJnZ3JCZ0VGQlFjQ0FSWWVhSFIwY0hNNkx5OTNkM2N1WVhCd2JHVXVZMjl0TDJGd2NHeGxZMkV2TUlIREJnZ3JCZ0VGQlFjQ0FqQ0J0aHFCczFKbGJHbGhibU5sSUc5dUlIUm9hWE1nWTJWeWRHbG1hV05oZEdVZ1lua2dZVzU1SUhCaGNuUjVJR0Z6YzNWdFpYTWdZV05qWlhCMFlXNWpaU0J2WmlCMGFHVWdkR2hsYmlCaGNIQnNhV05oWW14bElITjBZVzVrWVhKa0lIUmxjbTF6SUdGdVpDQmpiMjVrYVhScGIyNXpJRzltSUhWelpTd2dZMlZ5ZEdsbWFXTmhkR1VnY0c5c2FXTjVJR0Z1WkNCalpYSjBhV1pwWTJGMGFXOXVJSEJ5WVdOMGFXTmxJSE4wWVhSbGJXVnVkSE11TUEwR0NTcUdTSWIzRFFFQkJRVUFBNElCQVFCY05wbE1MWGkzN1l5YjNQTjNtL0oyMG5jd1Q4RWZoWU9GRzVrOVJ6ZnlxWnRBaml6VXNaQVMyTDcwYzV2dTBtUVB5M2xQTk5paVB2bDQvMnZJQit4OU9ZT0xVeURUT01TeHY1cFBDbXYvSy94WnB3VUpmQmRBVmhFZWROTzNpeU03UjZQVmJ5VGk2OUczY044UFJlRW55dkZ0ZU8zbnRSY1hxTngrSWpYS0pkWFpEOVpyMUtJa0l4SDNvYXlQYzRGZ3hodGJDUytTc3ZoRVNQQmdPSjRWOVQwbVp5Q0tNMnIzRFlMUDN1dWpML2xUYWx0a3dHTXpkL2M2Qnl4VzY5b1BJUTdhdW5NWlQ3WFpObi9CaDFYWnA1bTVNa0w3Mk5WeG5uNmhVcmNidlpOQ0pCSXF4dzhkdGsyY1htUElTNEFYVUtxSzFkcmsvTkFKQnpld2RYVWhNWUlDaFRDQ0FvRUNBUUV3ZnpCek1TMHdLd1lEVlFRRERDUkJjSEJzWlNCcFVHaHZibVVnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hJREFlQmdOVkJBc01GME5sY25ScFptbGpZWFJwYjI0Z1FYVjBhRzl5YVhSNU1STXdFUVlEVlFRS0RBcEJjSEJzWlNCSmJtTXVNUXN3Q1FZRFZRUUdFd0pWVXdJSVBWbjROK3JSMko4d0NRWUZLdzREQWhvRkFLQ0IzREFZQmdrcWhraUc5dzBCQ1FNeEN3WUpLb1pJaHZjTkFRY0JNQndHQ1NxR1NJYjNEUUVKQlRFUEZ3MHlOVEE0TWpReE5qTXhNREphTUNNR0NTcUdTSWIzRFFFSkJERVdCQlNudm52K2ZuT045a3Q3bklxS3RETi90UmhzblRBcEJna3Foa2lHOXcwQkNUUXhIREFhTUFrR0JTc09Bd0lhQlFDaERRWUpLb1pJaHZjTkFRRUJCUUF3VWdZSktvWklodmNOQVFrUE1VVXdRekFLQmdncWhraUc5dzBEQnpBT0JnZ3Foa2lHOXcwREFnSUNBSUF3RFFZSUtvWklodmNOQXdJQ0FVQXdCd1lGS3c0REFnY3dEUVlJS29aSWh2Y05Bd0lDQVNnd0RRWUpLb1pJaHZjTkFRRUJCUUFFZ2dFQUpRbG9lanl3Tnd5c3dFUVRLMzdOejdVZGpraWdVTEZGaGljM0lvM01vVXBVdTIxTmZtejc4anFjQStvNGh5QUJzaElSckVBVW5lRmgrb0NHL20vYmljanJqWTV2eHlzcS9ZQ2tKcGtwVEd6SmszdGwvTW8zVi84ZnJaaS9OZkJWRmhSeGJ5azJYY1RTVk42d3EyQnlEL1hNQms4dFhXSWRhMm5UdjA2THBSWGh3STl4NllZcjVDS1Z6bTdSVGd1bWJxRWJDakgyN0drOFM1UitNVzlmU3ZDKzI3VEQvdU5JTkxJemdnd2tCeVRPakM3MHBIZ1BlT21ZQUZ2b2tzTTRWaGN1eUdNa2EzR3RuQy9tTzViNjAxblhzUmVTd3E4K0g2UCtDS1dHOU82dmJNYXlob2drMlF1V0U1OWs2RC9qZ2F0SmNndnZNWUlGa2UwSDBtT08wdz09" | base64 --decode > /tmp/app.mobileprovision  # Replace PROFILE_BASE64_PLACEHOLDER with your base64 string

      - name: Check decoded provisioning profile
        run: |
          ls -l /tmp/app.mobileprovision
          file /tmp/app.mobileprovision || echo "File type check failed - may not be a valid mobileprovision file"

      - name: Extract provisioning profile details
        run: |
          security cms -D -i /tmp/app.mobileprovision > /tmp/decoded.plist
          PROFILE_UUID=$(/usr/libexec/PlistBuddy -c "Print :UUID" /tmp/decoded.plist)
          PROFILE_SPECIFIER=$(/usr/libexec/PlistBuddy -c "Print :Name" /tmp/decoded.plist)
          echo "PROFILE_UUID=$PROFILE_UUID" >> $GITHUB_ENV
          echo "PROFILE_SPECIFIER=$PROFILE_SPECIFIER" >> $GITHUB_ENV
          echo "Extracted PROFILE_UUID: $PROFILE_UUID"
          echo "Extracted PROFILE_SPECIFIER: $PROFILE_SPECIFIER"

      - name: Install provisioning profile
        run: |
          mkdir -p ~/Library/MobileDevice/Provisioning\ Profiles
          cp /tmp/app.mobileprovision ~/Library/MobileDevice/Provisioning\ Profiles/${{ env.PROFILE_UUID }}.mobileprovision

      - name: Extract bundle ID
        run: |
          BUNDLE_ID=$(/usr/libexec/PlistBuddy -c "Print :CFBundleIdentifier" ios/Runner/Info.plist)
          echo "BUNDLE_ID=$BUNDLE_ID" >> $GITHUB_ENV
          echo "Extracted BUNDLE_ID: $BUNDLE_ID"

      - name: Set hardcoded Team ID
        run: |
          echo "TEAM_ID=D296S46TFC" >> $GITHUB_ENV
          echo "Hardcoded TEAM_ID: $TEAM_ID"

      - name: Update Xcode project for manual signing
        run: |
          PROJECT_PATH="ios/Runner.xcodeproj/project.pbxproj"
          sed -i '' 's/CODE_SIGN_STYLE = Automatic;/CODE_SIGN_STYLE = Manual;/g' $PROJECT_PATH
          sed -i '' 's/DEVELOPMENT_TEAM = "";/DEVELOPMENT_TEAM = "${{ env.TEAM_ID }}";/g' $PROJECT_PATH
          sed -i '' 's/PROVISIONING_PROFILE_SPECIFIER = "";/PROVISIONING_PROFILE_SPECIFIER = "${{ env.PROFILE_SPECIFIER }}";/g' $PROJECT_PATH
          sed -i '' 's/CODE_SIGN_IDENTITY = "";/CODE_SIGN_IDENTITY = "Apple Distribution";/g' $PROJECT_PATH
          sed -i '' 's/CODE_SIGN_IDENTITY\[sdk=iphoneos\*\] = "";/CODE_SIGN_IDENTITY\[sdk=iphoneos\*\] = "Apple Distribution";/g' $PROJECT_PATH

      - name: Create export options plist
        run: |
          echo '<?xml version="1.0" encoding="UTF-8"?>' > exportOptions.plist
          echo '<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">' >> exportOptions.plist
          echo '<plist version="1.0">' >> exportOptions.plist
          echo '<dict>' >> exportOptions.plist
          echo '  <key>compileBitcode</key>' >> exportOptions.plist
          echo '  <false/>' >> exportOptions.plist
          echo '  <key>method</key>' >> exportOptions.plist
          echo '  <string>app-store</string>' >> exportOptions.plist
          echo '  <key>teamID</key>' >> exportOptions.plist
          echo "  <string>${{ env.TEAM_ID }}</string>" >> exportOptions.plist
          echo '  <key>provisioningProfiles</key>' >> exportOptions.plist
          echo '  <dict>' >> exportOptions.plist
          echo "    <key>${{ env.BUNDLE_ID }}</key>" >> exportOptions.plist
          echo "    <string>${{ env.PROFILE_SPECIFIER }}</string>" >> exportOptions.plist
          echo '  </dict>' >> exportOptions.plist
          echo '</dict>' >> exportOptions.plist
          echo '</plist>' >> exportOptions.plist
          cat exportOptions.plist  # Print for debugging

      - name: Remove FinderInfo xattr
        run: sudo xattr -r -d com.apple.FinderInfo . || true

      - name: Install xcodeproj gem
        run: sudo gem install xcodeproj

      - name: Add Release build configuration
        run: |
          ruby <<EOF
          require 'xcodeproj'

          def add_release_config(project)
            if project.build_configuration_list.build_configurations.none? { |bc| bc.name == 'Release' }
              base_name = project.build_configuration_list.build_configurations.find { |bc| bc.name == 'Profile' } ? 'Profile' : 'Debug'
              base_config = project.build_configuration_list[base_name]
              new_config = project.add_build_configuration('Release', :release)
              new_config.build_settings.merge!(base_config.build_settings)
            end

            project.targets.each do |target|
              if target.build_configuration_list.build_configurations.none? { |bc| bc.name == 'Release' }
                base_name = target.build_configuration_list.build_configurations.find { |bc| bc.name == 'Profile' } ? 'Profile' : 'Debug'
                base_config = target.build_configuration_list[base_name]
                new_config = target.add_build_configuration('Release', :release)
                new_config.build_settings.merge!(base_config.build_settings)
              end
            end
          end

          # Main project
          proj_path = 'ios/Runner.xcodeproj'
          project = Xcodeproj::Project.open(proj_path)
          add_release_config(project)
          project.save

          # Pods project (if exists)
          pods_proj_path = 'ios/Pods/Pods.xcodeproj'
          if File.exist?(pods_proj_path)
            pods_project = Xcodeproj::Project.open(pods_proj_path)
            add_release_config(pods_project)
            pods_project.save
          end
          EOF

      - name: Build IPA
        run: flutter build ipa --release --export-options-plist=exportOptions.plist -v

      - name: Upload IPA artifact
        uses: actions/upload-artifact@v4
        with:
          name: ios-app
          path: build/ios/ipa/*.ipa
          retention-days: 5  # Adjust as needed
